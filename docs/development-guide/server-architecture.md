# 后端架构介绍

本系统使用 Go 语言开发，前后端使用 gRPC-Web 进行通信，API 协议定义在 `proto/api.proto` 文件中。后端可以嵌入前端 Web 网站资源，这样只使用一个二进制就可以启动服务。后端服务除了提供 Web 访问界面以及接口以外，还负责评测任务的调度和评测机管理。

目前，考虑到系统一般用于 100 人左右的课堂教学，并发访问量以及总的数据量都不大，为了方便部署，数据存储使用了 `Pebble` KV 数据库，数据均存储在本地。如果有需要，可以修改 `repository` 下面的文件，实现不同 `Repository` 接口，对接其他的如 SQL 数据库存储。

另外，用户上传的文件也都将存储在本地。对于上传了的文件，系统会定时检查，如果超过一定时间没有提交，则会自动删除，以节省空间。

由于评测机和后端服务可能不是部署在同一台机器上，他们之间使用 gRPC 进行通信，并使用 HTTP 协议传输文件。用于评测机通信的端口和用于 Web 服务的端口不同，且 gRPC 和 HTTP 端口是分开的。也就是说后端服务需要占用三个端口。